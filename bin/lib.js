(()=>{"use strict";var t={d:(e,s)=>{for(var i in s)t.o(s,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:s[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{default:()=>k});class s{static encodeToUtf8(t){return s.__encodeToUtf8(t)}static decodeUtf8(t){return s.__decodeUtf8(t)}static __encodeToUtf8Impl(t){const e=t.length;let s,i,r=-1,n=512,h=new Uint8Array(n);for(s=0;s<e;++s){const e=t.codePointAt(s);if(void 0===e)throw new Error("Can't convert string to UTF-8. string include unexpected sequence.");if(i=e,i<=127)h[++r]=i;else if(i<=2047)h[++r]=192|i>>>6,h[++r]=128|63&i;else if(i<=65535)h[++r]=224|i>>>12,h[++r]=128|i>>>6&63,h[++r]=128|63&i;else{if(!(i<=1114111))throw new Error("Can't convert string to UTF-8. string include unexpected sequence.");h[++r]=240|i>>>18,h[++r]=128|i>>>12&63,h[++r]=128|i>>>6&63,h[++r]=128|63&i,65536<=i&&++s}if(n-r<=4){const t=h;n*=2,h=new Uint8Array(n),h.set(t)}}return h.subarray(0,++r)}static __decodeUtf8Impl(t){let e="",s=0;const i=t.length;let r,n,h,a;for(;s<i;)switch(r=t[s++],r>>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:e+=String.fromCodePoint(r);break;case 12:case 13:n=t[s++],e+=String.fromCodePoint((31&r)<<6|63&n);break;case 14:n=t[s++],h=t[s++],e+=String.fromCodePoint((15&r)<<12|(63&n)<<6|(63&h)<<0);break;case 16:if(r>>>3&1)throw new Error("Can't convert UTF-8 to string. UTF-8 include unexpected sequence.");n=t[s++],h=t[s++],a=t[s++],e+=String.fromCodePoint((7&r)<<18|(63&n)<<12|(63&h)<<6|(63&a)<<0)}return e}}s.__ctor=(s.isNode="undefined"!=typeof Buffer,s.isTextEncoder="undefined"!=typeof TextEncoder,void(s.isNode?(s.__encodeToUtf8=t=>Buffer.from(t,"utf8"),s.__decodeUtf8=t=>Buffer.from(Array.isArray(t)?t:Array.from(t)).toString("utf8")):s.isTextEncoder?(s.utf8Encoder=new TextEncoder("utf8"),s.__encodeToUtf8=t=>s.utf8Encoder.encode(t),s.utfDecoder=new TextDecoder("utf8"),s.__decodeUtf8=t=>s.utfDecoder.decode(t)):(s.__encodeToUtf8=s.__encodeToUtf8Impl,s.__decodeUtf8=s.__decodeUtf8Impl)));class i{static html(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}static xml(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}}class r{static loose(t,e=120){let s="",i=0;for(const r of t)i++,i>=e&&" \f\t\v".indexOf(r)>-1?(s+="\n",i=0):s+=r;return s}static normal(t,e=120){return r.loose(t,e)}static force(t,e=120){return r.loose(t,e)}}class n{constructor(t){if(this._r=0,this._g=0,this._b=0,this._a=1,!t)return;let e={r:0,g:0,b:0,a:1};if("object"==typeof t){if(t.hasOwnProperty("r")){const s=t;e={r:n.cutoff255(s.r),g:n.cutoff255(s.g),b:n.cutoff255(s.b),a:n.cutoff1(s.a||1)}}else if(t.hasOwnProperty("h")){const s=t;e=n.hslToRgb(s.h,s.s,s.l,s.a||1)}}else if("string"==typeof t){let s;if(s=n.isCode(t)||n.isName(t)||n.isRgb(t))e=s;else if(s=n.isHsl(t)){const t=s;e=n.hslToRgb(t.h,t.s,t.l,t.a)}}this._r=e.r,this._g=e.g,this._b=e.b,this._a=e.a}static cutoff255(t){return t<0?0:t>255?255:t}static cutoff1(t){return t<0?0:t>1?1:t}static isRgb(t){let e,s,i,r,h=1;return!!(r=t.match(/^\s*rgb(a?)\(\s*(-?(?:\d+\.)?\d+%?)\s*,\s*(-?(?:\d+\.)?\d+%?)\s*,\s*(-?(?:\d+\.)?\d+%?)\s*(?:,\s*((?:[01]?\.)?\d+)\s*)?\)\s*$/))&&(e=n.cutoff255(r[2].endsWith("%")?Math.round(Number.parseFloat(r[2])/100*255):Number.parseInt(r[2],10)),s=n.cutoff255(r[3].endsWith("%")?Math.round(Number.parseFloat(r[3])/100*255):Number.parseInt(r[3],10)),i=n.cutoff255(r[4].endsWith("%")?Math.round(Number.parseFloat(r[4])/100*255):Number.parseInt(r[4],10)),"a"===r[1]&&(h=n.cutoff1(Number.parseFloat(r[5]))),{r:e,g:s,b:i,a:h})}static isHsl(t){let e,s,i,r,h=1;return!!(r=t.match(/^\s*hsl(a?)\(\s*(-?(?:\d+\.)?\d+)\s*,\s*(-?(?:\d+\.)?\d+%?)\s*,\s*(-?(?:\d+\.)?\d+%?)\s*,\s*((?:[01]?\.)?\d+)\s*\)\s*$/))&&(e=Number.parseFloat(r[2])%360,e<0&&(e=360-e),s=n.cutoff1(r[3].endsWith("%")?Math.round(Number.parseFloat(r[3])/100):Number.parseFloat(r[3])),i=n.cutoff1(r[4].endsWith("%")?Math.round(Number.parseFloat(r[4])/100):Number.parseFloat(r[4])),"a"===r[1]&&(h=n.cutoff1(Number.parseFloat(r[5]))),{h:e,s,l:i,a:h})}static isCode(t){let e,s,i,r;return(r=t.match(/^\s*#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])\s*$/))?(e=Number.parseInt(`${r[1]}${r[1]}`,16),s=Number.parseInt(`${r[2]}${r[2]}`,16),i=Number.parseInt(`${r[3]}${r[3]}`,16),{r:e,g:s,b:i,a:1}):!!(r=t.match(/^\s*#([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})\s*$/))&&(e=Number.parseInt(r[1],16),s=Number.parseInt(r[2],16),i=Number.parseInt(r[3],16),{r:e,g:s,b:i,a:1})}static isName(t){if(n.colorNames.has(t)){const e=n.colorNames.get(t);return{r:e.r,g:e.g,b:e.b,a:1}}return!1}static fromRgba(t,e,s,i=1){const r=new n;return r._r=n.cutoff255(t),r._g=n.cutoff255(e),r._b=n.cutoff255(s),r._a=n.cutoff1(i),r}static hueToRgb(t,e,s){return s<0&&(s+=1),s>1&&(s-=1),6*s<1?t+(e-t)*s*6:2*s<1?e:3*s<2?t+(e-t)*(2/3-s)*6:t}static hslToRgb(t,e,s,i=1){t%=360,e=n.cutoff1(e),t<0&&(t=360-t);const r=(s=n.cutoff1(s))<=.5?s*(e+1):s+e-s*e,h=2*s-r;return{r:n.hueToRgb(h,r,t+1/3),g:n.hueToRgb(h,r,t),b:n.hueToRgb(h,r,t-1/3),a:n.cutoff1(i)}}static fromHsla(t,e,s,i=1){t%=360,e=n.cutoff1(e),s=n.cutoff1(s),t<0&&(t=360-t);const r=new n,h=s<=.5?s*(e+1):s+e-s*e,a=2*s-h;return r._r=n.hueToRgb(a,h,t+1/3),r._g=n.hueToRgb(a,h,t),r._b=n.hueToRgb(a,h,t-1/3),r._a=n.cutoff1(i),r}static fromGray(t,e=1){const s=new n;return s._r=n.cutoff255(t),s._g=n.cutoff255(t),s._b=n.cutoff255(t),s._a=n.cutoff1(e),s}get r(){return this._r}get g(){return this._g}get b(){return this._b}get a(){return this._a}toString(){return 1!==this._a?this.toRgbaString():this.toCode()}toCode(){return"#"+`0${this._r.toString(16)}`.slice(-2)+`0${this._g.toString(16)}`.slice(-2)+`0${this._b.toString(16)}`.slice(-2)}toRgbString(){return`rgb(${this._r},${this._g},${this._b})`}toRgbaString(){return`rgb(${this._r},${this._g},${this._b},${this._a})`}toHsla(){const t=this._r/255,e=this._g/255,s=this._b/255,i=Math.max(e,s),r=Math.min(e,s);let n=0,h=0;const a=(i+r)/2,o=i-r;return i!==r&&(n=i===t?(e-s)/o:i===e?(s-t)/o+2:(t-e)/o+4,n=60*n+(n<0?360:0),h=o/(a<.5?i+r:2-i-r)),{h:n,s:h,l:a,a:this._a}}toHslString(){const t=this.toHsla();return`hsl(${t.h},${t.s}%,${t.l}%)`}toHslaString(){const t=this.toHsla();return`hsl(${t.h},${t.s}%,${t.l}%,${this._a})`}}n.colorNames=new Map([["red",{r:255,g:0,b:0}],["darkred",{r:139,g:0,b:0}],["maroon",{r:128,g:0,b:0}],["brown",{r:165,g:42,b:42}],["firebrick",{r:178,g:34,b:34}],["sienna",{r:160,g:82,b:45}],["saddlebrown",{r:139,g:69,b:19}],["peru",{r:205,g:133,b:63}],["indianred",{r:205,g:92,b:92}],["rosybrown",{r:188,g:143,b:143}],["lightcoral",{r:240,g:128,b:128}],["salmon",{r:250,g:128,b:114}],["darksalmon",{r:233,g:150,b:122}],["coral",{r:255,g:127,b:80}],["tomato",{r:255,g:99,b:71}],["sandybrown",{r:244,g:164,b:96}],["lightsalmon",{r:255,g:160,b:122}],["chocolate",{r:210,g:105,b:30}],["orangered",{r:255,g:69,b:0}],["orange",{r:255,g:165,b:0}],["darkorange",{r:255,g:140,b:0}],["tan",{r:210,g:180,b:140}],["peachpuff",{r:255,g:218,b:185}],["bisque",{r:255,g:228,b:196}],["moccasin",{r:255,g:228,b:181}],["navajowhite",{r:255,g:222,b:173}],["wheat",{r:245,g:222,b:179}],["burlywood",{r:222,g:184,b:135}],["darkgoldenrod",{r:184,g:134,b:11}],["goldenrod",{r:218,g:165,b:32}],["gold",{r:255,g:215,b:0}],["yellow",{r:255,g:255,b:0}],["lightgoldenrodyellow",{r:250,g:250,b:210}],["palegoldenrod",{r:238,g:232,b:170}],["khaki",{r:240,g:230,b:140}],["darkkhaki",{r:189,g:183,b:107}],["blanchedalmond",{r:255,g:235,b:205}],["lightyellow",{r:255,g:255,b:224}],["cornsilk",{r:255,g:248,b:220}],["antiquewhite",{r:250,g:235,b:215}],["papayawhip",{r:255,g:239,b:213}],["papayawhite",{r:255,g:239,b:213}],["lemonchiffon",{r:255,g:250,b:205}],["beige",{r:245,g:245,b:220}],["oldlace",{r:253,g:245,b:230}],["lightcyan",{r:224,g:255,b:255}],["aliceblue",{r:240,g:248,b:255}],["whitesmoke",{r:245,g:245,b:245}],["lavenderblush",{r:255,g:240,b:245}],["floralwhite",{r:255,g:250,b:240}],["mintcream",{r:245,g:255,b:250}],["ghostwhite",{r:248,g:248,b:255}],["honeydew",{r:240,g:255,b:240}],["seashell",{r:255,g:245,b:238}],["ivory",{r:255,g:255,b:240}],["azure",{r:240,g:255,b:255}],["snow",{r:255,g:250,b:250}],["white",{r:255,g:255,b:255}],["gainsboro",{r:220,g:220,b:220}],["lightgrey",{r:211,g:211,b:211}],["silver",{r:192,g:192,b:192}],["darkgray",{r:169,g:169,b:169}],["lightslategray",{r:119,g:136,b:153}],["slategray",{r:112,g:128,b:144}],["gray",{r:128,g:128,b:128}],["dimgray",{r:105,g:105,b:105}],["darkslategray",{r:47,g:79,b:79}],["black",{r:0,g:0,b:0}],["lawngreen",{r:124,g:252,b:0}],["greenyellow",{r:173,g:255,b:47}],["chartreuse",{r:127,g:255,b:0}],["lime",{r:0,g:255,b:0}],["limegreen",{r:50,g:205,b:50}],["yellowgreen",{r:154,g:205,b:50}],["olive",{r:128,g:128,b:0}],["olivedrab",{r:107,g:142,b:35}],["darkolivegreen",{r:85,g:107,b:47}],["forestgreen",{r:34,g:139,b:34}],["darkgreen",{r:0,g:100,b:0}],["green",{r:0,g:128,b:0}],["seagreen",{r:46,g:139,b:87}],["mediumseagreen",{r:60,g:179,b:113}],["darkseagreen",{r:143,g:188,b:143}],["lightgreen",{r:144,g:238,b:144}],["palegreen",{r:152,g:251,b:152}],["springgreen",{r:0,g:255,b:127}],["mediumspringgreen",{r:0,g:250,b:154}],["teal",{r:0,g:128,b:128}],["darkcyan",{r:0,g:139,b:139}],["lightseagreen",{r:51,g:153,b:153}],["mediumaquamarine",{r:102,g:205,b:170}],["cadetblue",{r:95,g:158,b:160}],["steelblue",{r:70,g:130,b:180}],["aquamarine",{r:127,g:255,b:212}],["powderblue",{r:176,g:224,b:230}],["paleturquoise",{r:175,g:238,b:238}],["lightblue",{r:173,g:216,b:230}],["lightsteelblue",{r:176,g:196,b:222}],["skyblue",{r:135,g:206,b:235}],["lightskyblue",{r:135,g:206,b:250}],["mediumturquoise",{r:72,g:209,b:204}],["turquoise",{r:64,g:224,b:208}],["darkturquoise",{r:0,g:206,b:209}],["aqua",{r:0,g:255,b:255}],["cyan",{r:0,g:255,b:255}],["deepskyblue",{r:0,g:191,b:255}],["dodgerblue",{r:30,g:144,b:255}],["cornflowerblue",{r:100,g:149,b:237}],["royalblue",{r:65,g:105,b:225}],["blue",{r:0,g:0,b:255}],["mediumblue",{r:0,g:0,b:205}],["navy",{r:0,g:0,b:128}],["darkblue",{r:0,g:0,b:139}],["midnightblue",{r:25,g:25,b:112}],["darkslateblue",{r:72,g:61,b:139}],["mediumslateblue",{r:123,g:104,b:238}],["slateblue",{r:106,g:90,b:205}],["darkorchid",{r:153,g:50,b:204}],["darkviolet",{r:148,g:0,b:211}],["blueviolet",{r:138,g:43,b:226}],["mediumorchid",{r:186,g:85,b:211}],["plum",{r:221,g:160,b:221}],["lavender",{r:230,g:230,b:250}],["thistle",{r:216,g:191,b:216}],["orchid",{r:218,g:112,b:214}],["magenta",{r:255,g:0,b:255}],["fuchsia",{r:255,g:0,b:255}],["violet",{r:238,g:130,b:238}],["indigo",{r:75,g:0,b:130}],["darkmagenta",{r:139,g:0,b:139}],["purple",{r:128,g:0,b:128}],["mediumpurple",{r:147,g:112,b:219}],["mediumvioletred",{r:199,g:21,b:133}],["deeppink",{r:255,g:20,b:147}],["hotpink",{r:255,g:105,b:180}],["crimson",{r:220,g:20,b:60}],["palevioletred",{r:219,g:112,b:147}],["lightpink",{r:255,g:182,b:193}],["pink",{r:255,g:192,b:203}],["mistyrose",{r:255,g:228,b:225}]]);const h=class{static decimalPlaces(t){return e=>Number(e.toFixed(t))}static precision(t){return e=>Number(e.toPrecision(t))}}.decimalPlaces(6);class a{constructor(t,e){this.x=t,this.y=e}toString(){return`${this.x},${this.y}`}}class o{constructor(t,e){this.x=t,this.y=e}static fromPoints(t,e){return new o(e.x-t.x,e.y-t.y)}isZero(){return 0===this.x&&0===this.y}getLength(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))}getAngle(){let t=Math.acos(this.x/Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)));return 0>this.y&&(t=2*Math.PI-t),t}static getAngle(t,e){const s=Math.sqrt(Math.pow(t.x,2)+Math.pow(t.y,2)),i=Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2));return Math.acos((t.x*e.x+t.y*e.y)/(s*i))}toString(){return`${this.x},${this.y}`}}class l{constructor(t,e,s,i){this.x=t,this.y=e,this.w=s,this.h=i}}class c{constructor(t,e,s,i,r,n){this.m11=1,this.m21=0,this.dx=0,this.m12=0,this.m22=1,this.dy=0,t&&("object"==typeof t?(this.m11=t.m11||this.m11,this.m12=t.m12||this.m12,this.m21=t.m21||this.m21,this.m22=t.m22||this.m22,this.dx=t.dx||this.dx,this.dy=t.dy||this.dy):(this.m11=t||this.m11,this.m12=e||this.m12,this.m21=s||this.m21,this.m22=i||this.m22,this.dx=r||this.dx,this.dy=n||this.dy))}toString(){return`${this.m11} ${this.m12} ${this.m21} ${this.m22} ${this.dx} ${this.dy}`}isIdentity(){return 1===this.m11&&0===this.m21&&0===this.dx&&0===this.m12&&1===this.m22&&0===this.dy}scale(t,e){return this.concat(new c(t,0,0,e,0,0))}translate(t,e){return this.concat(new c(1,0,0,1,t,e))}rotate(t){return this.concat(new c(Math.cos(t),Math.sin(t),-Math.sin(t),Math.cos(t),0,0))}skewX(t){return this.concat(new c(1,0,Math.tan(t),1,0,0))}skewY(t){return this.concat(new c(1,Math.tan(t),0,1,0,0))}concat(t){return new c(this.m11*t.m11+this.m21*t.m12,this.m12*t.m11+this.m22*t.m12,this.m11*t.m21+this.m21*t.m22,this.m12*t.m21+this.m22*t.m22,this.m11*t.dx+this.m21*t.dy+this.dx,this.m12*t.dx+this.m22*t.dy+this.dy)}transfer(t,e){return"object"==typeof t?new a(h(this.m11*t.x+this.m21*t.y+this.dx),h(this.m12*t.x+this.m22*t.y+this.dy)):[h(this.m11*t+this.m21*e+this.dx),h(this.m12*t+this.m22*e+this.dy)]}getInverse(){return new c(this.m22,-this.m12,-this.m21,this.m11,this.m21*this.dy-this.dx*this.m22,this.dx*this.m12-this.m11*this.dy)}}class g{constructor(t,e,s,i,r){this.url=t,this.x=e,this.y=s,this.width=i,this.height=r}}class u{}class p extends u{constructor(t,e,s,i,r){super(),this.id=t,this.x0=e,this.y0=s,this.x1=i,this.y1=r,this.content=`<linearGradient id="${t}" gradientUnits="userSpaceOnUse" x1="${e}" y1="${s}" x2="${i}" y2="${r}" >\n`}addColorStop(t,e,s=1){this.content+=`<stop offset="${t}" stop-color="${e}" stop-opacity="${s}" />\n`}toDef(){return this.content+"</linearGradient>"}toString(){return`url(#${this.id})`}}class d extends u{constructor(t,e,s,i,r,n){super(),this.id=t,this.cx=e,this.cy=s,this.r=i,this.fx=r,this.fy=n,this.content=`<radialGradient id="${t}" gradientUnits="userSpaceOnUse" cx="${e}" cy="${s}" r="${i}" fx="${r}" fy="${n}" >\n`}addColorStop(t,e,s=1){this.content+=`<stop offset="${t}" stop-color="${e}" stop-opacity="${s}" />\n`}toDef(){return this.content+"</radialGradient>"}toString(){return`url(#${this.id})`}}class f{constructor(t,e){this.id=t,this.imageData=e}toDef(){const t=`<image x="0" y="0" width="${this.imageData.width}" height="${this.imageData.height}" \nxlink:href="${this.imageData.url}" />`;return`<pattern id="${this.id}"  patternUnits="userSpaceOnUse" patternContentUnits="userSpaceOnUse" x="${this.imageData.x}" y="${this.imageData.y}" width="${this.imageData.width}" height="${this.imageData.height}">${t}</pattern>`}toString(){return`url(#${this.id})`}}class m{constructor(t){if(this.globalAlpha=1,this.globalCompositeOperation="source-over",this.shadowBlur=0,this.shadowColor="rgba(0,0,0,1)",this.shadowOffsetX=0,this.shadowOffsetY=0,this.filterIdUrl=null,this.font="normal 12px 'Times New Roman'",this.textAlign="start",this.textBaseline="auto",this.lineCap="butt",this.lineDashOffset=0,this.lineJoin="miter",this.lineWidth=1,this.miterLimit=4,this.strokeStyle="black",this.fillStyle="black",this.ctm=new c,this.currentPoint=null,this.currentPointOnCtm=null,this.subpath=[],this.lineDash=[],this.clipPath="",t){for(const e in this)this.hasOwnProperty(e)&&t.hasOwnProperty(e)&&(this[e]=t[e]);this.subpath=Array.from(this.subpath)}}}class b{constructor(){this.graphicsStack=[],this.assets=[],this.content="",this.contentSaved="",this.idCount=0,this.template=null,this._fontHeightRatio=1.25,this.graphicsStack.push(new m)}get globalAlpha(){return this.graphicsStack[this.graphicsStack.length-1].globalAlpha}set globalAlpha(t){this.graphicsStack[this.graphicsStack.length-1].globalAlpha=t}get globalCompositeOperation(){return this.graphicsStack[this.graphicsStack.length-1].globalCompositeOperation}set globalCompositeOperation(t){this.filterIdUrl=null,this.graphicsStack[this.graphicsStack.length-1].globalCompositeOperation=t}get shadowBlur(){return this.graphicsStack[this.graphicsStack.length-1].shadowBlur}set shadowBlur(t){this.filterIdUrl=null,this.graphicsStack[this.graphicsStack.length-1].shadowBlur=t}get shadowColor(){return this.graphicsStack[this.graphicsStack.length-1].shadowColor}set shadowColor(t){this.filterIdUrl=null,this.graphicsStack[this.graphicsStack.length-1].shadowColor=t}get shadowOffsetX(){return this.graphicsStack[this.graphicsStack.length-1].shadowOffsetX}set shadowOffsetX(t){this.filterIdUrl=null,this.graphicsStack[this.graphicsStack.length-1].shadowOffsetX=t}get shadowOffsetY(){return this.graphicsStack[this.graphicsStack.length-1].shadowOffsetY}set shadowOffsetY(t){this.filterIdUrl=null,this.graphicsStack[this.graphicsStack.length-1].shadowOffsetY=t}get filterIdUrl(){return this.graphicsStack[this.graphicsStack.length-1].filterIdUrl}set filterIdUrl(t){this.graphicsStack[this.graphicsStack.length-1].filterIdUrl=t}get font(){return this.graphicsStack[this.graphicsStack.length-1].font}set font(t){this.graphicsStack[this.graphicsStack.length-1].font=t}get textAlign(){return this.graphicsStack[this.graphicsStack.length-1].textAlign}set textAlign(t){this.graphicsStack[this.graphicsStack.length-1].textAlign=t}get textBaseline(){return this.graphicsStack[this.graphicsStack.length-1].textBaseline}set textBaseline(t){this.graphicsStack[this.graphicsStack.length-1].textBaseline=t}get lineCap(){return this.graphicsStack[this.graphicsStack.length-1].lineCap}set lineCap(t){this.graphicsStack[this.graphicsStack.length-1].lineCap=t}get lineDashOffset(){return this.graphicsStack[this.graphicsStack.length-1].lineDashOffset}set lineDashOffset(t){this.graphicsStack[this.graphicsStack.length-1].lineDashOffset=t}get lineJoin(){return this.graphicsStack[this.graphicsStack.length-1].lineJoin}set lineJoin(t){this.graphicsStack[this.graphicsStack.length-1].lineJoin=t}get lineWidth(){return this.graphicsStack[this.graphicsStack.length-1].lineWidth}set lineWidth(t){this.graphicsStack[this.graphicsStack.length-1].lineWidth=t}get miterLimit(){return this.graphicsStack[this.graphicsStack.length-1].miterLimit}set miterLimit(t){this.graphicsStack[this.graphicsStack.length-1].miterLimit=t}get strokeStyle(){return this.graphicsStack[this.graphicsStack.length-1].strokeStyle}set strokeStyle(t){this.graphicsStack[this.graphicsStack.length-1].strokeStyle=t.toString()}get fillStyle(){return this.graphicsStack[this.graphicsStack.length-1].fillStyle}set fillStyle(t){this.graphicsStack[this.graphicsStack.length-1].fillStyle=t.toString()}get ctm(){return this.graphicsStack[this.graphicsStack.length-1].ctm}set ctm(t){this.graphicsStack[this.graphicsStack.length-1].ctm=t}get currentPoint(){return this.graphicsStack[this.graphicsStack.length-1].currentPoint}set currentPoint(t){this.graphicsStack[this.graphicsStack.length-1].currentPoint=t}get currentPointOnCtm(){return this.graphicsStack[this.graphicsStack.length-1].currentPointOnCtm}set currentPointOnCtm(t){this.graphicsStack[this.graphicsStack.length-1].currentPointOnCtm=t}get subpath(){return this.graphicsStack[this.graphicsStack.length-1].subpath}set subpath(t){this.graphicsStack[this.graphicsStack.length-1].subpath=t}get lineDash(){return this.graphicsStack[this.graphicsStack.length-1].lineDash}set lineDash(t){this.graphicsStack[this.graphicsStack.length-1].lineDash=t}get clipPath(){return this.graphicsStack[this.graphicsStack.length-1].clipPath}set clipPath(t){this.graphicsStack[this.graphicsStack.length-1].clipPath=t}get subpathIsEmptyOrClosed(){return 0===this.subpath.length||"Z"===this.subpath[this.subpath.length-1]}static fromTemplate(t){const e=new b;return e.template=t,e.idCount=(new Date).getTime(),e}render(t,e="mm"){const s='xmlns="http://www.w3.org/2000/svg"',i='xmlns:xlink="http://www.w3.org/1999/xlink"',r=`viewBox="${t.x} ${t.y} ${t.w} ${t.h}"`,n=`<defs>\n${this.assets.map((t=>"string"==typeof t?t:t.toDef())).join("\n")}</defs>`;if(this.template){let h=this.template.replace(/<\/svg>\s*$/,"");{const s=/(<svg[^>]*?)\s+?width\s*?=\s*?["'](?:[^"'>]+?)["']([^>]*?>)/;h=s.test(h)?h.replace(s,`$1 width="${t.w}${e}"$2`):h.replace(/<svg\s/,`<svg width="${t.w}${e}" `)}{const s=/(<svg[^>]*?)\s+?height\s*?=\s*?["'](?:[^"'>]+?)["']([^>]*?>)/;h=s.test(h)?h.replace(s,`$1 height="${t.h}${e}"$2`):h.replace(/<svg\s/,`<svg height="${t.h}${e}" `)}{const t=/(<svg[^>]*?)\s+?viewBox\s*?=\s*?["'](?:[^"'>]+?)["']([^>]*?>)/;h=t.test(h)?h.replace(t,`$1 ${r}$2`):h.replace(/<svg\s/,`<svg ${r} `)}return h.match(/<svg[^>]*?\s+?xmlns:xlink\s*?=/)||(h=h.replace(/<svg\s/,`<svg ${i} `)),h.match(/<svg[^>]*?\s+?xmlns\s*?=/)||(h=h.replace(/<svg\s/,`<svg ${s} `)),`${h}\n${n}\n${this.contentSaved}${this.content}</svg>`}return`<svg ${s} ${i} version="1.1" width="${t.w}${e}" height="${t.h}${e}" ${r}>\n${n}\n${this.contentSaved}${this.content}</svg>`}toDataUrl(t,e="mm",i=120){return"data:image/svg+xml;base64,"+class{static encode(t,e){let s=[];const i=t.length;let r=0,n=0,h=0;for(let e=0,a=0;e<i;e++)a=e%3,0===a?(r=t[e],h=r<<4&48,r=r>>>2&63):1===a?(r=t[e],n=r<<2&60,r=r>>>4&15|h,h=n):(n=t[e],r=n>>>6&3|h,r<26?r+=65:r<52?r+=71:r<62?r-=4:r=r<63?43:47,s.push(r),r=63&n),r<26?r+=65:r<52?r+=71:r<62?r-=4:r=r<63?43:47,s.push(r);for(i%3&&(h<26?h+=65:h<52?h+=71:h<62?h-=4:h=h<63?43:47,s.push(h));s.length%4;)s.push(61);if(e&&0<e){const t=[];for(let i=0;i<s.length;i+=e)t.push(...s.slice(i,i+e),10);s=t}let a="";for(let t=0;t<s.length;t++)a+=String.fromCharCode(s[t]);return a}static decode(t){const e=[];let s=0,i=0,r=0;const n=t.length;let h=0,a=0;for(;s<n;s++){if(i=(s+r)%4,h=t.charCodeAt(s),65<=h&&h<=90)h-=65;else if(97<=h&&h<=122)h-=71;else if(48<=h&&h<=57)h+=4;else if(43===h)h=62;else{if(47!==h){if(61===h)break;r++;continue}h=63}0===i?a=h<<2&252:1===i?(e.push(a|h>>>4&3),a=h<<4&240):2===i?(e.push(a|h>>>2&15),a=h<<6&192):e.push(a|63&h)}return e}}.encode(s.encodeToUtf8(this.render(t,e)),i)}save(){const t=new m(this.graphicsStack[this.graphicsStack.length-1]);this.graphicsStack.push(t)}restore(t=!1){if(t)0<this.graphicsStack.length&&this.graphicsStack.pop();else if(0<this.graphicsStack.length){const t=this.subpath,e=this.currentPoint,s=this.currentPointOnCtm;this.graphicsStack.pop(),this.subpath=t,this.currentPoint=e,this.currentPointOnCtm=s}}scale(t,e){if(null!==this.currentPointOnCtm){const s=(new c).scale(t,e);this.currentPointOnCtm=s.transfer(this.currentPointOnCtm)}this.ctm=this.ctm.scale(t,e)}translate(t,e){if(null!==this.currentPointOnCtm){const s=(new c).translate(t,e);this.currentPointOnCtm=s.transfer(this.currentPointOnCtm)}this.ctm=this.ctm.translate(t,e)}rotate(t){if(null!==this.currentPointOnCtm){const e=(new c).rotate(t);this.currentPointOnCtm=e.transfer(this.currentPointOnCtm)}this.ctm=this.ctm.rotate(t)}transform(t,e,s,i,r,n){const h=new c(t,e,s,i,r,n);null!==this.currentPointOnCtm&&(this.currentPointOnCtm=h.transfer(this.currentPointOnCtm)),this.ctm=this.ctm.concat(h)}setTransform(t,e,s,i,r,n){this.currentPointOnCtm=null,this.ctm=new c(t,e,s,i,r,n)}beginPath(){this.subpath=[],this.currentPoint=null,this.currentPointOnCtm=null}closePath(){this.subpath.push("Z"),this.currentPoint=null,this.currentPointOnCtm=null}moveTo(t,e){const s=new a(t,e);this.subpath.push("M",this.ctm.transfer(s)),this.currentPoint=this.subpath[this.subpath.length-1],this.currentPointOnCtm=s}lineTo(t,e,...s){let i=new a(t,e);if(this.subpath.push("L",this.ctm.transfer(i)),s&&s.length%4==0)for(let t=0;t<s.length&&!(s.length<=t+1);t+=2)i=new a(s[t],s[t+1]),this.subpath.push(this.ctm.transfer(i));this.currentPoint=this.subpath[this.subpath.length-1],this.currentPointOnCtm=i}quadraticCurveTo(t,e,s,i,...r){let n=new a(s,i);if(this.subpath.push("Q",this.ctm.transfer(new a(t,e)),this.ctm.transfer(n)),r&&r.length%4==0)for(let t=0;t<r.length&&!(r.length<=t+1);t+=2)n=new a(r[t],r[t+1]),this.subpath.push(this.ctm.transfer(n));this.currentPoint=this.subpath[this.subpath.length-1],this.currentPointOnCtm=n}bezierCurveTo(t,e,s,i,r,n,...h){let o=new a(r,n);if(this.subpath.push("C",this.ctm.transfer(new a(t,e)),this.ctm.transfer(new a(s,i)),this.ctm.transfer(o)),h&&h.length%6==0)for(let t=0;t<h.length;t+=2)o=new a(h[t],h[t+1]),this.subpath.push(this.ctm.transfer(o));this.currentPoint=this.subpath[this.subpath.length-1],this.currentPointOnCtm=o}arc(t,e,s,i,r,n=!1){const h=Math.abs(r-i)>=2*Math.PI;Math.abs(i)>2*Math.PI&&(i%=2*Math.PI),i<0&&(i=2*Math.PI+i),Math.abs(r)>2*Math.PI&&(r%=2*Math.PI),r<0&&(r=2*Math.PI+r),h?r=i+2*Math.PI:(n&&([i,r]=[r,i]),r<i&&(r+=2*Math.PI));let o=r-i,l=0;const g=Math.PI/2,u=4*(Math.sqrt(2)-1)/3,p=(new c).translate(t,e).scale(s,s);let d=[];for(;g<o;l+=g,o-=g){const t=p.rotate(i+l);0===d.length&&d.push(t.transfer(new a(1,0))),d.push(t.transfer(new a(1,u))),d.push(t.transfer(new a(u,1))),d.push(t.transfer(new a(0,1)))}const f=4*Math.tan(o/4)/3;{const t=p.rotate(i+l);0===d.length&&d.push(t.transfer(new a(1,0))),d.push(t.transfer(new a(1,f))),d.push(t.transfer(new a(Math.cos(o)+f*Math.sin(o),Math.sin(o)-f*Math.cos(o)))),d.push(t.transfer(new a(Math.cos(o),Math.sin(o))))}n&&(d=d.reverse());const m=d[d.length-1];d=d.map((t=>this.ctm.transfer(t))),this.subpath.push(this.subpathIsEmptyOrClosed?"M":"L",d.shift(),"C"),this.subpath.push(...d),this.currentPoint=this.subpath[this.subpath.length-1],this.currentPointOnCtm=m}arcTo(t,e,s,i,r){const n=this.currentPointOnCtm;if(null===n)return;const h=new a(t,e),l=new a(s,i),c=o.fromPoints(n,h),g=o.fromPoints(h,l);if(0===c.x&&0===g.x||0===c.y&&0===g.y||c.isZero()||g.isZero())return this.subpath.push("L",this.ctm.transfer(h),this.ctm.transfer(l)),void(this.currentPointOnCtm=l);const u=o.getAngle(c,g);if(0===u||u===Math.PI)return this.subpath.push("L",this.ctm.transfer(h),this.ctm.transfer(l)),void(this.currentPointOnCtm=l);const p=Math.PI-u,d=r/Math.sin(p/2),f=Math.abs(Math.cos(p/2)*d);let m=o.fromPoints(h,n).getAngle(),b=g.getAngle();const $=new a(f*Math.cos(m)+h.x,f*Math.sin(m)+h.y),k=new a(f*Math.cos(b)+h.x,f*Math.sin(b)+h.y);Math.abs(b-m)>Math.PI&&(b>m?m+=2*Math.PI:b+=2*Math.PI);const w=new a(d*Math.cos((m+b)/2)+h.x,d*Math.sin((m+b)/2)+h.y),S=o.fromPoints(w,$),x=o.fromPoints(w,k);let y=S.getAngle(),P=x.getAngle();Math.abs(P-y)>Math.PI&&(P>y?y+=2*Math.PI:P+=2*Math.PI),this.arc(w.x,w.y,r,y,P,y>=P),this.lineTo(s,i)}circle(t,e,s,i=!0){this.subpathIsEmptyOrClosed||this.closePath(),this.arc(t,e,s,0,2*Math.PI,i),this.closePath()}rect(t,e,s,i,r=!0){r?this.subpath.push("M",this.ctm.transfer(new a(t,e)),"L",this.ctm.transfer(new a(t,e+i)),this.ctm.transfer(new a(t+s,e+i)),this.ctm.transfer(new a(t+s,e)),"Z"):this.subpath.push("M",this.ctm.transfer(new a(t,e)),"L",this.ctm.transfer(new a(t+s,e)),this.ctm.transfer(new a(t+s,e+i)),this.ctm.transfer(new a(t,e+i)),"Z"),this.currentPoint=null,this.currentPointOnCtm=null}roundRect(t,e,s,i,r,n=!0){n?(this.moveTo(t,e+i/2),this.arcTo(t,e+i,t+s/2,e+i,r),this.arcTo(t+s,e+i,t+s,e+i/2,r),this.arcTo(t+s,e,t+s/2,e,r),this.arcTo(t,e,t,e+i/2,r)):(this.moveTo(t+s/2,e),this.arcTo(t+s,e,t+s,e+i/2,r),this.arcTo(t+s,e+i,t+s/2,e+i,r),this.arcTo(t,e+i,t,e+i/2,r),this.arcTo(t,e,t+s/2,e,r)),this.closePath()}getInheritedStyle(t){let e;const s=t.toString();let i,r=this.globalAlpha;if(i=n.isRgb(s)){const e=i;r*=e.a,t=`rgb(${e.r},${e.g},${e.b})`}else if(i=n.isHsl(s)){const e=i;r*=e.a,t=`hsl(${e.h},${100*e.s}%,${100*e.l}%)`}else this.ctm.isIdentity()||((e=s.match(/^url\(\#lgrad-(.+)\)$/))?(this.assets.push(`<linearGradient id="lgrad-${++this.idCount}" xlink:href="#lgrad-${e[1]}" gradientTransform="matrix(${this.ctm.toString()})" />`),t=`url(#lgrad-${this.idCount})`):(e=s.match(/^url\(\#rgrad-(.+)\)$/))?(this.assets.push(`<radialGradient id="rgrad-${++this.idCount}" xlink:href="#rgrad-${e[1]}" gradientTransform="matrix(${this.ctm.toString()})" />`),t=`url(#rgrad-${this.idCount})`):(e=s.match(/^url\(\#pat-(.+)\)$/))&&(this.assets.push(`<pattern id="pat-${++this.idCount}" xlink:href="#pat-${e[1]}" patternTransform="matrix(${this.ctm.toString()})" />`),t=`url(#pat-${this.idCount})`));return{style:t,alpha:r}}getStrokeAttrs(){const t=this.getInheritedStyle(this.strokeStyle);return`stroke="${t.style}" stroke-width="${this.lineWidth}" stroke-linecap="${this.lineCap}" stroke-linejoin="${this.lineJoin}" stroke-miterlimit="${this.miterLimit}" `+(this.getLineDash().length>0?`stroke-dasharray="${this.getLineDash().join(",")}" stroke-dashoffset="${this.lineDashOffset}" `:"")+`stroke-opacity="${t.alpha}" `}getFillAttrs(t){const e=this.getInheritedStyle(this.fillStyle);return`fill="${e.style}" fill-rule="${t}" fill-opacity="${e.alpha}" `}getFilterAttrs(){if(""===this.filterIdUrl);else if(null===this.filterIdUrl){if(0<this.shadowBlur||this.globalCompositeOperation&&"source-over"!==this.globalCompositeOperation){let t="",e="";if(0<this.shadowBlur)if(t+=`<feGaussianBlur stdDeviation="${this.shadowBlur}" result="blur" />\n<feOffset in="blur" dx="${this.shadowOffsetX}" dy="${this.shadowOffsetY}" result="offsetBlur" />\n`,null===this.shadowColor)e+='<feMergeNode in="offsetBlur" />';else{const s=new n(this.shadowColor);t+=`<feColorMatrix in="offsetBlur" type="matrix" values=" 1 1 1 0 0  1 1 1 0 0  1 1 1 0 0  0 0 0 1 0 " result="color1" />\n<feColorMatrix in="color1" type="matrix" values=" ${s.r/255} 0 0 0 0  0 ${s.g/255} 0 0 0  0 0 ${s.b/255} 0 0  0 0 0 ${s.a} 0 " result="color2" />\n`,e+='<feMergeNode in="color2" />\n'}if(this.globalCompositeOperation&&"source-over"!==this.globalCompositeOperation){let s=this.globalCompositeOperation,i=!1;switch(s){case"destination-in":i=!0;case"source-in":s="in";break;case"destination-out":i=!0;case"source-out":s="out";break;case"destination-atop":i=!0;case"source-atop":s="atop";break;case"xor":s="xor";break;case"destination-over":i=!0;default:s="over"}t+=`<feComposite in${i?"2":""}="SourceGraphic" in${i?"":"2"}="BackgroundImage" operator="${s}" result="comp"/>\n`,e+='<feMergeNode in="comp" />\n'}else e+='<feMergeNode in="SourceGraphic" />\n';return this.assets.push(`<filter id="filter-${++this.idCount}" filterUnits="userSpaceOnUse">\n${t}<feMerge>\n${e}</feMerge>\n</filter>`),this.filterIdUrl=`url(#filter-${this.idCount})`,`filter="${this.filterIdUrl}" `}this.filterIdUrl=""}else if(""!==this.filterIdUrl)return`filter="${this.filterIdUrl}" `;return""}getMultilineTextHeight(t){if(t.multiline&&"string"==typeof this.font&&(void 0===t.lineHeight||null===t.lineHeight)){const e=new RegExp("^\\s*(?:normal|italic|oblique)?s*(?:normal|small-caps)?\\s*(?:normal|bold|lighter|bolder|100|200|300|400|500|600|700|800|900)??\\s*(?:([0-9.]+)(px|pt|mm|cm|in|pc)?)(?:\\/(?:([0-9.]+|normal)(px|pt|mm|cm|in|em|%)?))?").exec(this.font);if(e){let s=Number(e[1]);switch(e[2]){case"pt":s=s/72*96;break;case"pc":s=s/72*96/12;break;case"mm":s=s/25.4*96;break;case"cm":s=s/25.4*96*100;break;case"in":s*=96}let i=s;if(e[3])switch(i=Number(e[3])||1.3,e[4]){case"px":break;case"pt":i=i/72*96;break;case"pc":i=i/72*96/12;break;case"mm":i=i/25.4*96;break;case"cm":i=i/25.4*96*100;break;case"in":i*=96;break;case"%":i=i/100*s;break;default:i*=s}t.lineHeight=i}}return t}getTextFontStyles(){return`font:${i.xml(this.font)};`}getTextAttributes(t){let e,s;switch(this.textAlign){case"left":e="start";break;case"right":e="end";break;case"center":e="middle";break;default:e=this.textAlign}switch(this.textBaseline){case"top":s="text-before-edge";break;case"bottom":s="text-after-edge";break;default:s=this.textBaseline}let i=` style="${this.getTextFontStyles()}" text-anchor="${e}" dominant-baseline="${s}"`;if(null==t)return i;if("number"==typeof t)return i+=` textLength="${t}"`,i;const r=this.getMultilineTextHeight(t);return void 0!==r.textLength&&null!==r.textLength&&(i+=` textLength="${r.textLength}"`),void 0!==r.lengthAdjust&&null!==r.lengthAdjust&&(i+=` lengthAdjust="${r.lengthAdjust}"`),void 0!==r.rotate&&null!==r.rotate&&(i+=` rotate="${r.rotate}"`),void 0!==r.writingMode&&null!==r.writingMode&&(i+=` writing-mode="${r.writingMode}"`),void 0!==r.glyphOrientationVertical&&null!==r.glyphOrientationVertical&&(i+=` glyph-orientation-vertical="${r.glyphOrientationVertical}"`),void 0!==r.glyphOrientationHorizontal&&null!==r.glyphOrientationHorizontal&&(i+=` glyph-orientation-horizontal="${r.glyphOrientationHorizontal}"`),void 0!==r.direction&&null!==r.direction&&(i+=` direction="${r.direction}"`),void 0!==r.unicodeBidi&&null!==r.unicodeBidi&&(i+=` unicode-bidi="${r.unicodeBidi}"`),void 0!==r.textDecoration&&null!==r.textDecoration&&(i+=` text-decoration="${r.textDecoration}"`),void 0!==r.kerning&&null!==r.kerning&&(i+=` kerning="${r.kerning}"`),void 0!==r.letterSpacing&&null!==r.letterSpacing&&(i+=` letter-spacing="${r.letterSpacing}"`),void 0!==r.wordSpacing&&null!==r.wordSpacing&&(i+=` word-spacing="${r.wordSpacing}"`),i}getTextPath(t){if(null!=t&&"object"==typeof t&&t.textPath){const e=this.ctm.getInverse(),s=[];for(const t of this.subpath)t instanceof a?s.push(e.transfer(t)):s.push(t);const i="path-"+ ++this.idCount;this.assets.push(`<path id="${i}" d="${r.loose(s.join(" "))}" />\n`),this.subpath=[],this.currentPoint=null,this.currentPointOnCtm=null;const n={id:`#${i}`};return void 0!==t.textPathOffset&&null!==t.textPathOffset&&(n.offset=t.textPathOffset),n}return null}convertToMultiline(t,e,s,r){if(null!=r&&"object"==typeof r&&r.multiline&&!r.textPath){const n=r.lineHeight||12,h=t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),a=i.xml(h).split("\n");switch(r.writingMode){case"tb":case"tb-rl":return`<tspan>${a.join(`</tspan><tspan dx="${-n}" y="${s}">`)}</tspan>`;default:return`<tspan>${a.join(`</tspan><tspan x="${e}" dy="${n}">`)}</tspan>`}}return`<tspan x="${e}" y="${s}">${i.xml(t)}</tspan>`}stroke(){this.content+=`<g ${this.getStrokeAttrs()}fill="none"${this.getFilterAttrs()}`+(this.clipPath.length>0?` clip-path="${this.clipPath}" `:"")+`>\n<path d="${r.loose(this.subpath.join(" "))}" />\n</g>\n`}strokeRect(t,e,s,i){this.content+=`<g ${this.getStrokeAttrs()}fill="none"${this.getFilterAttrs()}`+(this.clipPath.length>0?` clip-path="${this.clipPath}" `:"")+`>\n<rect x="${t}" y="${e}" width="${s}" height="${i}" `+`transform="matrix(${this.ctm.toString()})" /></g>\n`}strokeText(t,e,s,i){const r=this.getTextPath(i);this.content+=`<g ${this.getStrokeAttrs()}fill="none"${this.getFilterAttrs()}`+(this.clipPath.length>0?` clip-path="${this.clipPath}" `:"")+">\n<text"+`${this.getTextAttributes(i)} transform="matrix(${this.ctm.toString()})" \n>`+(null!==r?`<textPath xlink:href="${r.id}"${void 0!==r.offset?` startOffset="${r.offset}"`:""}\n>`:"")+this.convertToMultiline(t,e,s,i)+(null!==r?"</textPath>":"")+"</text></g>\n"}fill(t="nonzero"){this.content+=`<g stroke="none" ${this.getFillAttrs(t)}${this.getFilterAttrs()}`+(this.clipPath.length>0?` clip-path="${this.clipPath}" `:"")+`>\n<path d="${r.loose(this.subpath.join(" "))}" />\n</g>\n`}fillRect(t,e,s,i){this.content+=`<g stroke="none" ${this.getFillAttrs("nonzero")}${this.getFilterAttrs()}`+(this.clipPath.length>0?` clip-path="${this.clipPath}" `:"")+`>\n<rect x="${t}" y="${e}" width="${s}" height="${i}" `+`transform="matrix(${this.ctm.toString()})" /></g>\n`}fillText(t,e,s,i){const r=this.getTextPath(i);this.content+=`<g stroke="none" ${this.getFillAttrs("nonzero")}${this.getFilterAttrs()}`+(this.clipPath.length>0?` clip-path="${this.clipPath}" `:"")+">\n<text"+`${this.getTextAttributes(i)} transform="matrix(${this.ctm.toString()})" \n>`+(null!==r?`<textPath xlink:href="${r.id}"${void 0!==r.offset?` startOffset="${r.offset}"`:""}\n>`:"")+this.convertToMultiline(t,e,s,i)+(null!==r?"</textPath>":"")+"</text></g>\n"}fillStroke(t="nonzero"){this.content+=`<g ${this.getFillAttrs(t)}${this.getStrokeAttrs()}${this.getFilterAttrs()}`+(this.clipPath.length>0?` clip-path="${this.clipPath}" `:"")+`>\n<path d="${r.loose(this.subpath.join(" "))}" />\n</g>\n`}fillStrokeRect(t,e,s,i){this.content+=`<g ${this.getFillAttrs("nonzero")}${this.getStrokeAttrs()}${this.getFilterAttrs()}`+(this.clipPath.length>0?` clip-path="${this.clipPath}" `:"")+`>\n<rect x="${t}" y="${e}" width="${s}" height="${i}" `+`transform="matrix(${this.ctm.toString()})" /></g>\n`}fillStrokeText(t,e,s,i){const r=this.getTextPath(i);this.content+=`<g ${this.getFillAttrs("nonzero")}${this.getStrokeAttrs()}${this.getFilterAttrs()}`+(this.clipPath.length>0?` clip-path="${this.clipPath}" `:"")+">\n<text"+`${this.getTextAttributes(i)} transform="matrix(${this.ctm.toString()})" \n>`+(null!==r?`<textPath xlink:href="${r.id}"${void 0!==r.offset?` startOffset="${r.offset}"`:""}\n>`:"")+this.convertToMultiline(t,e,s,i)+(null!==r?"</textPath>":"")+"</text></g>\n"}getLineDash(){return this.lineDash}setLineDash(t){this.lineDash=t}clip(t="nonzero"){const e=`<clipPath id="clip-${++this.idCount}" fill-rule="${t}" ><path d="${r.loose(this.subpath.join(" "))}" /></clipPath>`;this.assets.push(e),this.clipPath=`url(#clip-${this.idCount})`}registerImage(t,e){const s=t=this.convertImageToSvgImageData(t),i=null==e?`img-${++this.idCount}_w${s.width}_h${s.height}`:e,r=`<image id="${i}" \nx="0" y="0" width="1" height="1" preserveAspectRatio="none" xlink:href="${s.url}" />`;return this.assets.push(r),`#${i}`}registerCustomFilter(t,e){this.assets.push(e),this.filterIdUrl=`url(#${t})`}registerCustomAsset(t){this.assets.push(t)}appendCustomContent(t){this.content+=`<g transform="matrix(${this.ctm.toString()})">${t}</g>\n`}createLinearGradient(t,e,s,i){const r=new p("lgrad-"+ ++this.idCount,t,e,s,i);return this.assets.push(r),r}createRadialGradient(t,e,s,i,r,n){const h=new d("rgrad-"+ ++this.idCount,t,e,s,i,r);return this.assets.push(h),h}createPattern(t,e){const s=new f("pat-"+ ++this.idCount,this.convertImageToSvgImageData(t));return this.assets.push(s),s}beginPattern(){this.contentSaved=this.content,this.content="";const t=new m;this.graphicsStack.push(t)}endPattern(t,e,s,i){const r=++this.idCount,n=`<pattern id="pat-${r}" patternUnits="userSpaceOnUse" patternContentUnits="userSpaceOnUse" x="${t}" y="${e}" width="${s}" height="${i}">\n${this.content}</pattern>`;return this.assets.push(n),this.content=this.contentSaved,this.contentSaved="",this.restore(),`url(#pat-${r})`}convertImageToSvgImageData(t){let e;if("undefined"!=typeof HTMLImageElement&&t instanceof HTMLImageElement){const s=document.createElement("canvas");s.width=t.width,s.height=t.height;const i=s.getContext("2d");if(null===i)throw new Error("SvgCanvas#convertImageToSvgImageData: Can't get context from Canvas.");i.drawImage(t,0,0),e=new g(s.toDataURL(),0,0,s.width,s.height)}else e="undefined"!=typeof HTMLCanvasElement&&t instanceof HTMLCanvasElement?new g(t.toDataURL(),0,0,t.width,t.height):t;return e}drawImage(t,e,s,i,r){let n;if(n="string"==typeof t?new g(t,0,0,i,r):this.convertImageToSvgImageData(t),n.url.startsWith("#")){const t=this.ctm.translate(e,s).scale(i,r);this.content+=`<g><use x="0" y="0" transform="matrix(${t.toString()})" \nxlink:href="${n.url}" /></g>\n`}else this.content+=`<g><image x="${e}" y="${s}" width="${i}" height="${r}" preserveAspectRatio="none" transform="matrix(${this.ctm.toString()})" \nxlink:href="${n.url}" /></g>\n`}beginGroup(){this.content+="<g>"}endGroup(){this.content+="</g>"}get fontHeightRatio(){return this._fontHeightRatio}set fontHeightRatio(t){this._fontHeightRatio=t}measureText(t){const e=this.font.match(/(\d+(?:.\d+)?)(px|pt|in|mm|em|rem|%)/);let s=1,i=12;if(e){switch(e[2]){case"pt":s=96/72;break;case"in":s=96;break;case"mm":s=1/25.4*96;break;case"em":case"rem":s=12;break;case"%":s=.01}i=Number.parseFloat(e[1])}return{width:Math.round(s*i*Array.from(t.replace(/[\u200B-\u200D\uFEFF\u200E\u200F]/g,"").normalize("NFKC")).length/this.fontHeightRatio)}}clearRect(t,e,s,i){this.save(),this.fillStyle="white",this.fillRect(t,e,s,i),this.restore()}}const $=Function("return this")();function k(t,e){const s=new b;s.canvas={width:800,height:400,style:{width:"800px",height:"400px"}},s.resetTransform=function(){},s.fontHeightRatio=2;const i={getContext:()=>s};void 0===e.options&&(e.options={}),e.options.devicePixelRatio=1,e.options.animation=!1,e.options.events=[],e.options.responsive=!1;const r=$.CanvasGradient;$.CanvasGradient=u;try{new t.Chart(i,e)}finally{r&&($.CanvasGradient=r)}return s.render(new l(0,0,800,400),"px")}module.exports.render=e})();
//# sourceMappingURL=lib.js.map